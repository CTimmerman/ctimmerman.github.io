<html>

<head>
    <title>Die Roller, by Cees Timmerman</title>
    <link rel="icon"
	href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 112 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸŽ²</text></svg>">
    <style>
        body {
            text-align: center;
        }

        #results,
        button {
            font-weight: bold;
        }
    </style>
</head>

<body>
    <h1>Die Roller</h1>
    <div id='results'>
    </div>
    <button onclick='roll()'>Roll die</button> <button onclick='do_clear()'>Clear</button>
    <script>
        'use strict'
        let results = document.getElementById('results')
        async function roll() {
            let what = await prompt('Die count and type:', '1d6').toLowerCase()
            let [count, sides] = what.split('d')
            let result = []
            let histogram = {}
            for (let i = 0; i < count; ++i) {
                let number = Math.ceil(Math.random() * sides)
                result.push(number)
                if (number in histogram) histogram[number] += 1
                else histogram[number] = 1
            }
            let histr = ''
            for (const [k, v] of Object.entries(histogram)) histr += `${k}: ${v}, `
            histr = `<br>(${histr} total: ${result.reduce((a, b) => a + b)})`
            console.log(histr)
            let p = document.createElement('p')
            p.innerHTML = what + ':<br>' + result.join(', ') + (count > 1 ? histr : '')
            results.append(p)
        }
        function do_clear() {
            results.innerText = ''
        }
    </script>
</body>

</html>